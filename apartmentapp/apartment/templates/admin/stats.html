{% extends 'admin/base_site.html' %}
{% block content %}
<h1>THỐNG KÊ THÔNG TIN CHUNG CƯ</h1>
<h2>Apartment Details</h2>

<ul>
    {% for c in apartment_stats %}
    {% if c.active == True %}
    <li>Số phòng đã được thuê/mua<strong>: {{ c.count }}</strong></li>
    {% else %}
    <li>Số phòng còn trống<strong>: {{ c.count }}</strong></li>
    {%endif%}
    {% endfor %}
</ul>
<ul>
        {% for apartment in apartmentdetail_stats %}
            <li>{{ apartment.name }} - Active: {{ apartment.active }}</li>
        {% endfor %}
    </ul>




<div style="display:flex">
    <div style="width:50%">
        {% include 'admin/thongkecanho.html' %}
    </div>
    <div style="width:50%">
        <canvas id="myChart"></canvas>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let labels=[];
    let data=[];
    {% for c in apartment_stats %}
        labels.push('{{c.active}}')
        data.push({{c.count}})
    {% endfor %}
window.onload=function(){
const ctx = document.getElementById('myChart');

  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: labels,
      datasets: [{
        label: 'so luong',
        data: data,
        borderWidth: 1,
        backgroundColor: ['red','green','blue']
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
}

</script>


<h3>==============================================</h3>
<!--<ul>-->
<!--    {% for c in hoa_don %}-->
<!--<p>id: {{ c.id }}</p>-->
<!--<p>name: {{ c.name }}</p>-->
<!--<p>Total Paid: {{ c.count }}</p>-->
<!--    {% endfor %}-->
<!--</ul>-->
    <h2>Invoices</h2>
    <ul>
        {% for h in hoa_don %}
            <li>
                Invoice ID: {{ h.id }} - Name: {{ h.name }} - Total Price: {{ h.count }}
                <ul>
                    {% for hd in hoa_don_dich_vu %}
                        {% if hd.hoadon_id == h.id %}
                          {% for d in dich_vu %}
                                {% if hd.dichvu_id == d.id %}
                                        <li> {{ d.id }}-{{ d.name }} - Price:{{d.giaDV}}</li>
                                {% endif %}
                          {% endfor %}
                        {% endif %}
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>
<link rel="stylesheet" href="https://unpkg.com/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="https://unpkg.com/bs-brain@2.0.4/components/cards/card-1/assets/css/card-1.css">
{% endblock %}